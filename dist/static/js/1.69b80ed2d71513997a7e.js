webpackJsonp([1],{Erju:function(t,s){},elIH:function(t,s){},g6Xh:function(t,s){},gytv:function(t,s){},lzQb:function(t,s,e){"use strict";var o={props:{selectType:{type:Number,default:2},onlyContent:{type:Boolean,default:!1},desc:{type:Object,default:function(){return{all:"全部",positive:"满意",negative:"不满意"}}},ratings:{type:Array,default:function(){return[]}}},computed:{positives:function(){return this.ratings.filter(function(t){return 0===t.rateType})},negatives:function(){return this.ratings.filter(function(t){return 1===t.rateType})}},methods:{select:function(t){this.$emit("select",t)},toggleContent:function(){this.$emit("toggle")}}},n={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"ratingselect"},[e("div",{staticClass:"rating-type border-1px"},[e("span",{staticClass:"block positive",class:{active:2===t.selectType},on:{click:function(s){t.select(2)}}},[t._v(t._s(t.desc.all)),e("span",{staticClass:"count"},[t._v(t._s(t.ratings.length))])]),t._v(" "),e("span",{staticClass:"block positive",class:{active:0===t.selectType},on:{click:function(s){t.select(0)}}},[t._v(t._s(t.desc.positive)),e("span",{staticClass:"count"},[t._v(t._s(t.positives.length))])]),t._v(" "),e("span",{staticClass:"block negative",class:{active:1===t.selectType},on:{click:function(s){t.select(1)}}},[t._v(t._s(t.desc.negative)),e("span",{staticClass:"count"},[t._v(t._s(t.negatives.length))])])]),t._v(" "),e("div",{staticClass:"toggleContent",class:{on:t.onlyContent},on:{click:t.toggleContent}},[e("span",{staticClass:"icon-check_circle"}),t._v(" "),e("span",{staticClass:"text"},[t._v("只看有内容的评论")])])])},staticRenderFns:[]};var i=e("VU/8")(o,n,!1,function(t){e("g6Xh")},null,null);s.a=i.exports},z99A:function(t,s){},zXAe:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=e("1P5+"),n=e("7+uW"),i={props:{food:{type:Object}},methods:{addCount:function(t){this.food.count?this.food.count++:n.a.set(this.food,"count",1),this.$emit("add",t.target)},decrease:function(t){this.food.count&&this.food.count--}}},a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"control"},[e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.food.count>0,expression:"food.count > 0"}],staticClass:"decrease",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.decrease(s)}}},[e("span",{staticClass:"inner icon-remove_circle_outline"})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.food.count,expression:"food.count"}],staticClass:"count"},[t._v(t._s(t.food.count))]),t._v(" "),e("div",{staticClass:"increase icon-add_circle",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.addCount(s)}}})],1)},staticRenderFns:[]};var r=e("VU/8")(i,a,!1,function(t){e("z99A")},"data-v-9b9484d2",null).exports,l={props:{selectFoods:{type:Array,default:function(){return[{price:0,count:0}]}},deliveryPrice:{type:Number,default:0},minPrice:{type:Number,default:0}},data:function(){return{balls:[{show:!1},{show:!1},{show:!1},{show:!1}],dropBalls:[],fold:!0,listShow:!1}},activated:function(){this.$refs.logoWrapper.style.animationPlayState=""},computed:{totalPrice:function(){var t=0;return this.selectFoods.forEach(function(s){t+=s.count*s.price}),t},totalCount:function(){var t=0;return this.selectFoods.forEach(function(s){t+=s.count}),t},payDesc:function(){return this.totalPrice>=20?"去结算":this.totalPrice>0?"还差￥"+(this.minPrice-this.totalPrice)+"元起送":"￥"+this.minPrice+"元起送"}},methods:{afterEnter:function(){this.$refs.listContent.refresh()},empty:function(){this.selectFoods.forEach(function(t){t.count=0})},pay:function(){this.totalPrice>=this.minPrice&&window.alert("支付"+this.totalPrice+"元")},toogleList:function(){this.totalCount&&(this.fold=!this.fold)},addFood:function(t){this.drop(t),this.scaleSpring()},scaleSpring:function(){var t=this;this.$refs.logoWrapper.style.animation="none",this.$nextTick(function(){t.$refs.logoWrapper.style.animation=null,t.$refs.logoWrapper.style.animationPlayState="running"})},drop:function(t){for(var s=0;s<this.balls.length;s++){var e=this.balls[s];if(!e.show)return e.show=!0,e.el=t,void this.dropBalls.push(e)}},beforDrop:function(t){console.log(t);for(var s=this.balls.length;s--;){var e=this.balls[s];if(e.show){var o=e.el.getBoundingClientRect();console.log(o);var n=o.left-32,i=-(window.innerHeight-o.top-22);t.style.display="",t.style.webkitTransform="translate3d(0,"+i+"px,0)",t.style.transform="translate3d(0,"+i+"px,0)";var a=t.getElementsByClassName("inner-hook")[0];a.style.webkitTransform="translate3d("+n+"px,0,0)",a.style.transform="translate3d("+n+"px,0,0)"}}},dropping:function(t,s){console.log(t);t.offsetHeight;this.$nextTick(function(){t.style.webkitTransform="translate3d(0,0,0)",t.style.transform="translate3d(0,0,0)";var e=t.getElementsByClassName("inner-hook")[0];e.style.webkitTransform="translate3d(0,0,0)",e.style.transform="translate3d(0,0,0)",t.addEventListener("transitionend",s)})},afterDrop:function(t){var s=this.dropBalls.shift();s&&(s.show=!1,t.style.display="none")}},watch:{totalCount:function(){this.totalCount||(this.fold=!0)},fold:function(){this.listShow=!this.fold}},components:{ControlBtn:r,Scroll:o.a}},c={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"shopcart"},[e("div",{staticClass:"content"},[e("div",{staticClass:"content-left",on:{click:t.toogleList}},[e("transition",{attrs:{name:"cart"}},[e("div",{ref:"logoWrapper",staticClass:"logo-wrapper scaleSpring"},[e("div",{staticClass:"logo",class:{highlight:t.totalCount>0}},[e("i",{staticClass:"icon-shopping_cart",class:{highlight:t.totalCount>0}})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.totalCount>0,expression:"totalCount > 0"}],staticClass:"num"},[t._v(t._s(t.totalCount))])])]),t._v(" "),e("div",{staticClass:"price",class:{highlight:t.totalPrice>0}},[t._v("￥"+t._s(t.totalPrice))]),t._v(" "),e("div",{staticClass:"desc"},[t._v("另需配送费￥"+t._s(t.deliveryPrice)+"元")])],1),t._v(" "),e("div",{staticClass:"content-right",on:{click:t.pay}},[e("div",{staticClass:"pay",class:[t.totalPrice>=t.minPrice?"enough":"not-enough"]},[t._v("\r\n          "+t._s(t.payDesc)+"\r\n        ")])])]),t._v(" "),e("div",{staticClass:"ball-container"},t._l(t.balls,function(s,o){return e("div",{key:o},[e("transition",{attrs:{name:"drop"},on:{"before-enter":t.beforDrop,enter:t.dropping,"after-enter":t.afterDrop}},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.show,expression:"ball.show"}],staticClass:"ball"},[e("div",{staticClass:"inner inner-hook"})])])],1)})),t._v(" "),e("transition",{attrs:{name:"fold"},on:{"after-enter":t.afterEnter}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],staticClass:"shopcart-list"},[e("div",{staticClass:"list-header"},[e("h1",{staticClass:"title"},[t._v("购物车")]),t._v(" "),e("span",{staticClass:"empty",on:{click:t.empty}},[t._v("清空")])]),t._v(" "),e("scroll",{ref:"listContent",staticClass:"list-content",attrs:{data:t.selectFoods}},[e("ul",t._l(t.selectFoods,function(s,o){return e("li",{key:o,staticClass:"food"},[e("span",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),e("div",{staticClass:"price"},[e("span",[t._v("￥"+t._s(s.price*s.count))])]),t._v(" "),e("div",{staticClass:"cartcontrol-wrapper"},[e("control-btn",{attrs:{food:s},on:{add:t.addFood}})],1)])}))])],1)])],1),t._v(" "),e("div",[e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],staticClass:"list-mask",on:{click:function(s){t.listShow=!t.listShow}}})])],1)])},staticRenderFns:[]};var d=e("VU/8")(l,c,!1,function(t){e("elIH")},"data-v-32b1772a",null).exports,f=e("lzQb"),u=e("EVwS"),v=e("hhm8"),h={props:{food:{type:Object,default:function(){return{ratings:[]}}}},data:function(){return{showFlag:!1,selectType:2,onlyContent:!0,desc:{all:"全部",positive:"推荐",negative:"吐槽"}}},computed:{shownRatings:function(){var t=this;return this.food.ratings?this.food.ratings.filter(function(s){return t.needShow(s.rateType,s.text)}):[]}},methods:{addFood:function(t){this.$emit("add",t)},needShow:function(t,s){return!(this.onlyContent&&!s)&&(2===this.selectType||this.selectType===t)},selectRating:function(t){this.selectType=t,this.$refs.food.refresh()},toggleContent:function(){this.onlyContent=!this.onlyContent,this.$refs.food.refresh()},hide:function(){this.showFlag=!1},show:function(){var t=this;this.showFlag=!0,this.selectType=2,this.onlyContent=!0,this.$nextTick(function(){t.$refs.food.refresh()})},addFirst:function(t){n.a.set(this.food,"count",1),this.$emit("add",t.target)}},filters:{formatDate:function(t){return Object(v.b)(new Date(t),"yyyy-MM-dd hh:mm")}},components:{ControlBtn:r,Split:u.a,ratingselect:f.a,Scroll:o.a}},p={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("transition",{attrs:{name:"move"}},[e("scroll",{directives:[{name:"show",rawName:"v-show",value:t.showFlag,expression:"showFlag"}],ref:"food",staticClass:"food",attrs:{data:t.shownRatings}},[e("div",[e("div",{staticClass:"image-header"},[e("img",{attrs:{src:t.food.image}}),t._v(" "),e("div",{staticClass:"back",on:{click:t.hide}},[e("i",{staticClass:"icon-arrow_lift"})])]),t._v(" "),e("div",{staticClass:"content"},[e("h2",{staticClass:"title"},[t._v(t._s(t.food.name))]),t._v(" "),e("div",{staticClass:"detail"},[e("span",{staticClass:"sell-count"},[t._v("月售"+t._s(t.food.sellCount)+"份")]),t._v(" "),e("span",{staticClass:"rating"},[t._v("好评率"+t._s(t.food.rating)+"%")])]),t._v(" "),e("div",{staticClass:"price"},[e("span",{staticClass:"now"},[t._v("￥"+t._s(t.food.price))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.food.oldPrice,expression:"food.oldPrice"}],staticClass:"old"},[t._v("￥"+t._s(t.food.oldPrice))])]),t._v(" "),e("div",{staticClass:"control-wrapper"},[e("control-btn",{attrs:{food:t.food},on:{add:t.addFood}})],1),t._v(" "),e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.food.count||0===t.food.count,expression:"!food.count || food.count===0"}],staticClass:"buy",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.addFirst(s)}}},[t._v("\r\n            加入购物车\r\n          ")])])],1),t._v(" "),e("split",{directives:[{name:"show",rawName:"v-show",value:t.food.info,expression:"food.info"}]}),t._v(" "),t.food.info?e("div",{staticClass:"info"},[e("h1",{staticClass:"title"},[t._v("商品信息")]),t._v(" "),e("p",{staticClass:"text"},[t._v(t._s(t.food.info))])]):t._e(),t._v(" "),e("split"),t._v(" "),e("div",{staticClass:"rating"},[e("h2",{staticClass:"title"},[t._v("商品评价")]),t._v(" "),e("ratingselect",{attrs:{selectType:t.selectType,onlyContent:t.onlyContent,desc:t.desc,ratings:t.food.ratings},on:{select:t.selectRating,toggle:t.toggleContent}}),t._v(" "),e("div",{staticClass:"rating-wrapper"},[e("ul",t._l(t.shownRatings,function(s,o){return e("li",{key:o,staticClass:"rating-item border-1px"},[e("div",{staticClass:"user"},[e("span",{staticClass:"name"},[t._v(t._s(s.username))]),t._v(" "),e("img",{staticClass:"avatar",attrs:{src:s.avatar,width:"12",height:"12"}})]),t._v(" "),e("div",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(s.rateTime)))]),t._v(" "),e("p",{staticClass:"text"},[e("span",{class:[0===s.rateType?"icon-thumb_up":"icon-thumb_down"]}),t._v(t._s(s.text)+"\r\n              ")])])})),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.food.ratings||!t.food.ratings.length,expression:"!food.ratings || !food.ratings.length"}],staticClass:"no-rating"},[t._v("暂无评价")])])],1)],1)])],1)},staticRenderFns:[]};var _=e("VU/8")(h,p,!1,function(t){e("Erju")},null,null).exports,g=e("P9l9"),C={props:{seller:{type:Object}},data:function(){return{goods:[],listHeight:[],scrollY:0,selectedFood:{}}},created:function(){var t=this;this.clsArr=["decrease","discount","special","invoice","guarantee"],Object(g.b)().then(function(s){s.errno===g.a&&(t.goods=s.data,t.$nextTick(function(){t._calcHeight()}))})},methods:{selectFood:function(t,s){console.log(t,s),this.selectedFood=t,this.$refs.food.show()},addFood:function(t){var s=this;this.$nextTick(function(){s.$refs.shopCart.drop(t),s.$refs.shopCart.scaleSpring()})},selectMenu:function(t){var s=this.listHeight[t];console.log(s),this._scrollToFood(t)},foodListScroll:function(t){this.scrollY=t.y},_calcHeight:function(){var t=0,s=this.$refs.foodList;console.log(s),this.listHeight.push(t);for(var e=0;e<s.length;e++)this.listHeight.push(t+=s[e].clientHeight)},_scrollToFood:function(t){this.$refs.foodScroll.scrollToElement(this.$refs.foodList[t],300)},_scrollToMenu:Object(v.a)(function(t){this.$refs.menuScroll.scrollToElement(this.$refs.menuItem[t],300,0,!0)},40)},activated:function(){this.$refs.foodScroll.refresh()},computed:{currentIndex:function(){if(this.scrollY>=0)return 0;for(var t=0;t<this.listHeight.length;t++){var s=this.listHeight[t],e=this.listHeight[t+1];if(!e||-this.scrollY>=s&&-this.scrollY<e)return this._scrollToMenu(t),console.log(t,this.scrollY),t}return 0},selectFoods:function(){var t=[];return this.goods.forEach(function(s){s.foods.forEach(function(s){s.count&&t.push(s)})}),t}},components:{Scroll:o.a,ShopCart:d,ControlBtn:r,Food:_}},m={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"goods"},[e("scroll",{ref:"menuScroll",staticClass:"menu",attrs:{data:t.goods}},[e("ul",t._l(t.goods,function(s,o){return e("li",{key:o,ref:"menuItem",refInFor:!0,staticClass:"menu-item",class:{current:t.currentIndex===o},on:{click:function(s){t.selectMenu(o)}}},[e("p",{staticClass:"text border-1px"},[s.type>0?e("span",{staticClass:"icon",class:t.clsArr[s.type]}):t._e(),t._v(t._s(s.name)+"\r\n          ")])])}))]),t._v(" "),e("scroll",{ref:"foodScroll",staticClass:"goods-list",attrs:{data:t.goods,listenScroll:!0,probeType:3},on:{scroll:t.foodListScroll}},[e("ul",t._l(t.goods,function(s,o){return e("li",{key:o,ref:"foodList",refInFor:!0,staticClass:"food-list"},[e("h1",{staticClass:"title"},[t._v(t._s(s.name))]),t._v(" "),e("ul",t._l(s.foods,function(s,o){return e("li",{key:o,staticClass:"food-item border-1px",on:{click:function(e){t.selectFood(s,e)}}},[e("div",{staticClass:"icon"},[e("img",{attrs:{src:s.icon,width:"57",height:"57"}})]),t._v(" "),e("div",{staticClass:"content"},[e("h2",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),e("p",{staticClass:"desc"},[t._v(t._s(s.description))]),t._v(" "),e("div",{staticClass:"extra"},[e("span",{staticClass:"count"},[t._v("月售"+t._s(s.sellCount)+"份")]),e("span",[t._v("好评率"+t._s(s.rating)+"%")])]),t._v(" "),e("div",{staticClass:"price"},[e("span",{staticClass:"now"},[t._v("￥"+t._s(s.price))]),e("span",{directives:[{name:"show",rawName:"v-show",value:s.oldPrice,expression:"food.oldPrice"}],staticClass:"old"},[t._v("￥"+t._s(s.oldPrice))])]),t._v(" "),e("div",{staticClass:"cartcontrol-wrapper"},[e("control-btn",{attrs:{food:s},on:{add:t.addFood}})],1)])])}))])}))]),t._v(" "),e("shop-cart",{ref:"shopCart",attrs:{deliveryPrice:t.seller.deliveryPrice,minPrice:t.seller.minPrice,selectFoods:t.selectFoods}})],1),t._v(" "),e("food",{ref:"food",attrs:{food:t.selectedFood},on:{add:t.addFood}})],1)},staticRenderFns:[]};var w=e("VU/8")(C,m,!1,function(t){e("gytv")},"data-v-0d0cf551",null);s.default=w.exports}});
//# sourceMappingURL=1.69b80ed2d71513997a7e.js.map